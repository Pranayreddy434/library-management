// settings/LibrarySettingsService.java
package com.library.settings;

import jakarta.annotation.PostConstruct;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.math.BigDecimal;

@Service
@RequiredArgsConstructor
public class LibrarySettingsService {

    private final LibrarySettingsRepository repo;

    @PostConstruct
    public void initDefaults() {
        if (repo.count() == 0) {
            LibrarySettings s = LibrarySettings.builder()
                    .maxBorrowDays(14)
                    .reservationLimitPerUser(5)
                    .finePerDay(new BigDecimal("2.00"))
                    .build();
            repo.save(s);
        }
    }

    public LibrarySettings getSettings() {
        return repo.findAll().stream().findFirst().orElseThrow();
    }
}
